# Privoxy Configuration
# HTTP/HTTPS proxy with filtering, forwards to HAProxy (random Tor)

# Listen on all interfaces, port 8118
listen-address  0.0.0.0:8118

# Forward to HAProxy which distributes across Tor instances
forward-socks5 / 127.0.0.1:9999 .

# Or forward directly to a specific Tor instance (uncomment if preferred)
# forward-socks5 / 127.0.0.1:9050 .

# Logging
logdir /var/log/privoxy
logfile privoxy.log
debug 1     # Log connections
debug 1024  # Log actions

# Hostname handling
hostname tor-privoxy

# Buffer limits
buffer-limit 4096

# Toggle features
toggle 1
enable-remote-toggle 0
enable-remote-http-toggle 0
enable-edit-actions 0

# Filtering (basic privacy enhancements)
enforce-blocks 0

# Accept intercepted requests
accept-intercepted-requests 1

# Connection handling
keep-alive-timeout 300
socket-timeout 300

# Privacy enhancements
# Note: For maximum privacy, combine with browser hardening

# Actions file (default Privoxy filtering rules)
actionsfile /etc/privoxy/match-all.action
actionsfile /etc/privoxy/default.action
actionsfile /etc/privoxy/user.action

# Filter file
filterfile /etc/privoxy/default.filter
filterfile /etc/privoxy/user.filter